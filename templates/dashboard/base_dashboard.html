{% extends 'base.html' %}

{% block content %}
<div class="d-flex">
    <!-- Sidebar -->
    <nav class="sidebar" style="width: 280px;">
        <div class="p-4 border-bottom border-light border-opacity-25">
            <div class="d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    <div class="bg-white bg-opacity-20 p-2 rounded me-3">
                        {% if user.role == 'super_admin' %}
                            <i class="fas fa-shield-alt text-white"></i>
                        {% elif user.role == 'doctor' %}
                            <i class="fas fa-stethoscope text-white"></i>
                        {% elif user.role == 'nurse' %}
                            <i class="fas fa-heart text-white"></i>
                        {% else %}
                            <i class="fas fa-user text-white"></i>
                        {% endif %}
                    </div>
                    <span class="h4 font-display fw-bold text-white mb-0">MEDORA</span>
                </div>
            </div>
        </div>

        <div class="p-4 border-bottom border-light border-opacity-25">
            <div class="d-flex align-items-center">
                <div class="bg-white bg-opacity-20 rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                    <span class="text-white fw-bold">{{ user.first_name|first|default:user.username|first }}</span>
                </div>
                <div>
                    <p class="text-white fw-medium mb-0">{{ user.get_full_name|default:user.username }}</p>
                    <p class="text-white-50 small mb-0">{{ user.get_role_display }}</p>
                </div>
            </div>
        </div>

        <div class="p-4">
            <ul class="nav nav-pills flex-column">
                <li class="nav-item mb-2">
                    <a class="nav-link active" href="{% url 'dashboard:index' %}">
                        <i class="fas fa-home me-2"></i>Dashboard
                    </a>
                </li>
                
                {% if user.role == 'super_admin' %}
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="#">
                            <i class="fas fa-users-cog me-2"></i>User Management
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="#">
                            <i class="fas fa-chart-bar me-2"></i>System Reports
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="#">
                            <i class="fas fa-cog me-2"></i>Settings
                        </a>
                    </li>
                {% elif user.role == 'doctor' %}
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="{% url 'appointments:list' %}">
                            <i class="fas fa-calendar-alt me-2"></i>Appointments
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="{% url 'medical_records:list' %}">
                            <i class="fas fa-file-medical me-2"></i>Medical Records
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="#">
                            <i class="fas fa-users me-2"></i>Patients
                        </a>
                    </li>
                {% elif user.role == 'nurse' %}
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="#">
                            <i class="fas fa-tasks me-2"></i>Daily Tasks
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="{% url 'medical_records:vitals_list' %}">
                            <i class="fas fa-heartbeat me-2"></i>Vitals
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="#">
                            <i class="fas fa-users me-2"></i>Patients
                        </a>
                    </li>
                {% elif user.role == 'patient' %}
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="{% url 'appointments:list' %}">
                            <i class="fas fa-calendar-alt me-2"></i>My Appointments
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="{% url 'medical_records:list' %}">
                            <i class="fas fa-file-medical me-2"></i>Medical History
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="#">
                            <i class="fas fa-heartbeat me-2"></i>Health Records
                        </a>
                    </li>
                {% endif %}
            </ul>

            <div class="mt-auto pt-4">
                <ul class="nav nav-pills flex-column">
                    <li class="nav-item mb-2">
                        <a class="nav-link" href="{% url 'accounts:profile' %}">
                            <i class="fas fa-user me-2"></i>Profile
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'accounts:logout' %}">
                            <i class="fas fa-sign-out-alt me-2"></i>Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="flex-grow-1">
        <!-- Top Bar -->
        <header class="bg-white shadow-sm p-4 border-bottom">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h3 font-display fw-bold text-dark mb-1">
                        {% block dashboard_title %}{{ user.get_role_display }} Dashboard{% endblock %}
                    </h1>
                    <p class="text-muted mb-0">{{ current_date|date:"l, F j, Y" }}</p>
                </div>

                <div class="d-flex align-items-center">
                    <!-- Notifications -->
                    <div class="position-relative me-3">
                        <button class="btn btn-outline-secondary position-relative" id="notificationBtn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge" id="notificationCount">0</span>
                        </button>
                    </div>

                    <!-- User Avatar -->
                    <div class="bg-medora-teal rounded-circle d-flex align-items-center justify-content-center text-white fw-bold" style="width: 40px; height: 40px;">
                        {{ user.first_name|first|default:user.username|first }}
                    </div>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <main class="p-4">
            {% block dashboard_content %}{% endblock %}
        </main>
    </div>
</div>

{% block extra_js %}
<script>
// Notification functionality
document.addEventListener('DOMContentLoaded', function() {
    // Load notification count
    fetch('{% url "notifications:unread_count" %}')
        .then(response => response.json())
        .then(data => {
            document.getElementById('notificationCount').textContent = data.count;
        });
});
</script>
{% endblock %}
{% endblock %}